%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%
\label{chap:qmTwoPs4}
%
%\blogpage{http://sites.google.com/site/peeterjoot/math2011/qmTwoPs4.pdf}
%\date{Oct 12, 2011}
%
%\section{Problem 2}
%
I was deceived by an incorrect result in Mathematica, which led me to believe that the second order energy perturbation was zero (whereas part (c) of the problem asked if it was greater or lesser than zero).  I started starting writing this up to show my reasoning, but our Professor quickly provided an example after class showing how this zero must be wrong, and I did not have to show him any of this.
%
\paragraph{Setup.}
%
Recall first the one dimensional particle in a box.  Within the box we have to solve
%
\begin{equation}\label{eqn:qmTwoPs4:10}
\frac{P^2}{2m} \psi = E\psi,
\end{equation}
%
and find
%
\begin{equation}\label{eqn:qmTwoPs4:30}
\psi \sim
e^{\frac{i}{\Hbar} \sqrt{2 m E} x}.
\end{equation}
%
With
\begin{equation}\label{eqn:qmTwoPs4:50}
k = \frac{\sqrt{2 m E}}{\Hbar},
\end{equation}
%
our general state, involving terms of each sign, takes the form
\begin{equation}\label{eqn:qmTwoPs4:70}
\psi =
A e^{ i k x } +B e^{ -i k x }.
\end{equation}
%
Inserting boundary conditions gives us
%
\begin{equation}\label{eqn:qmTwoPs4:90}
\begin{bmatrix}
\psi(-L/2) \\
\psi(L/2)
\end{bmatrix}
\begin{bmatrix}
e^{ -i k \frac{L}{2} } +e^{ i k \frac{L}{2} } \\
e^{ i k \frac{L}{2} } +e^{ -i k \frac{L}{2} }
\end{bmatrix}
\begin{bmatrix}
A \\
B
\end{bmatrix}.
\end{equation}
%
The determinant is zero
%
\begin{equation}\label{eqn:qmTwoPs4:110}
e^{-i k L} - e^{i k L} = 0,
\end{equation}
%
which provides our constraint on \(k\)
%
\begin{equation}\label{eqn:qmTwoPs4:130}
e^{2 i k L} = 1.
\end{equation}
%
We require \(2 k L = 2 \pi n\) for any integer \(n\), or
%
\begin{equation}\label{eqn:qmTwoPs4:150}
k = \frac{\pi n}{L}.
\end{equation}
%
This quantizes the energy, and inverting \eqnref{eqn:qmTwoPs4:50} gives us
%
\begin{equation}\label{eqn:qmTwoPs4:170}
E = \inv{2m} \left( \frac{\Hbar \pi n }{L} \right)^2.
\end{equation}
%
To complete the task of matching boundary value conditions we cheat and recall that the particular linear combinations that we need to match the boundary constraint of zero at \(\pm L/2\) were sums and differences yielding cosines and sines respectively.  Since
%
\begin{equation}\label{eqn:qmTwoPs4:190}
\evalbar{\sin\left( \frac{\pi n x }{L} \right) }{x = \pm L/2} =
\pm \sin\left(\frac{\pi n}{2}\right).
\end{equation}
%
So sines are the wave functions for \(n = 2, 4, ...\) since \(\sin(n \pi) = 0\) for integer \(n\).  Similarly
%
\begin{equation}\label{eqn:qmTwoPs4:210}
\evalbar{\cos\left( \frac{\pi n x }{L} \right) }{x = \pm L/2} =
\cos\left(\frac{\pi n}{2}\right).
\end{equation}
%
Cosine becomes zero at \(\pi/2, 3\pi/2, \cdots\), so our wave function is the cosine for \(n = 1, 3, 5, \cdots\).
%
Normalizing gives us
%
\begin{equation}\label{eqn:qmTwoPs4:230}
\psi_n(x) = \sqrt{\frac{2}{L}}
\left\{
\begin{array}{l l}
\cos\left(\frac{\pi n x}{L}\right) & \quad n = 1, 3, 5, \cdots \\
\sin\left(\frac{\pi n x}{L}\right) & \quad n = 2, 4, 6, \cdots
\end{array}
\right.
\end{equation}
%
\paragraph{Two non-interacting particles.  Three lowest energy levels and degeneracies.}
%
Forming the Hamiltonian for two particles in the box without interaction, we have within the box
%
\begin{equation}\label{eqn:qmTwoPs4:250}
H =
\frac{P_1^2}{2m}
+\frac{P_2^2}{2m},
\end{equation}
%
we can apply separation of variables, and it becomes clear that our wave functions have the form
%
\begin{equation}\label{eqn:qmTwoPs4:270}
\psi_{nm}(x_1, x_2) = \psi_n(x_1) \psi_m(x_2).
\end{equation}
%
Plugging in
\begin{equation}\label{eqn:qmTwoPs4:290}
H \psi = E \psi,
\end{equation}
%
supplies the energy levels for the two particle wavefunction, giving
%
\begin{equation}\label{eqn:qmTwoPs4:310}
\begin{aligned}
H \psi_{nm}
&=
\frac{\Hbar^2}{2m}
\left(
\left(\frac{\pi n}{L}\right)^2
+\left(\frac{\pi m}{L}\right)^2
\right)
\psi_{nm} \\
&=
\frac{1}{2m} \left(\frac{\Hbar \pi}{L}\right)^2 ( n^2 + m^2 ) \psi_{nm}.
\end{aligned}
\end{equation}
%
Letting \(n, m\) each range over \([1,3]\) for example we find
%ATABXX
\begin{tablelabelbox}[tabularx={X|X|X}]{Varying the wave numbers.}{label=eqn:qmTwoPs4:330}
\eqnormal{n} & \eqnormal{m} & \eqnormal{n^2 + m^2}\\\hline\hline
1 & 1 & 2\\\hline
1 & 2 & 5\\\hline
1 & 3 & 10\\\hline
2 & 1 & 5\\\hline
2 & 2 & 8\\\hline
2 & 3 & 13\\\hline
3 & 1 & 10\\\hline
3 & 2 & 13\\\hline
3 & 3 & 18\\\hline
\end{tablelabelbox}
%
It is clear that our lowest energy levels are
%
\begin{equation}\label{eqn:qmTwoPs4:470}
\begin{aligned}
\frac{1}{m} \left(\frac{\Hbar \pi}{L}\right)^2  \\
\frac{5}{2m} \left(\frac{\Hbar \pi}{L}\right)^2  \\
\frac{4}{m} \left(\frac{\Hbar \pi}{L}\right)^2,
\end{aligned}
\end{equation}
%
with degeneracies \(1, 2, 1\) respectively.
%
\paragraph{Ground state energy with interaction perturbation to first order.}
%
With \(c_0\) positive and an interaction potential of the form
%
\begin{equation}\label{eqn:qmTwoPs4:350}
U(X_1, X_2) = - c_0 \delta(X_1 - X_2).
\end{equation}
%
The second order perturbation of the ground state energy is
%
\begin{equation}\label{eqn:qmTwoPs4:370}
E = E_{11}^{(0)} +
H_{11;11}' +
\sum_{nm \ne 11} \frac{\Abs{H_{11;11}' }^2}{E_{11} - E_{nm}},
\end{equation}
%
where
\begin{equation}\label{eqn:qmTwoPs4:390}
E_{11}^{(0)} = \frac{1}{m} \left(\frac{\Hbar \pi}{L}\right)^2,
\end{equation}
%
and
\begin{equation}\label{eqn:qmTwoPs4:410}
H_{nm;ab}' = -c_0 \bra{\psi_{nm}} \delta(X_1 - X_2) \ket{\psi_{ab}}.
\end{equation}
%
To proceed, we need to expand the matrix element
%
\begin{equation}\label{eqn:qmTwoPs4:490}
\begin{aligned}
\bra{\psi_{nm}} &\delta(X_1 - X_2) \ket{\psi_{ab}} \\
&=
\int dx_1 dx_2 dy_1 dy_2
\braket{\psi_{nm}}{x_1 x_2} \bra{x_1 x_2} \delta(X_1 - X_2) \ket{y_1 y_2 } \braket{y_1 y_2}{\psi_{ab}} \\
&=
\int dx_1 dx_2 dy_1 dy_2
\braket{\psi_{nm}}{x_1 x_2} \delta(x_1 - x_2) \delta^2(\Bx - \By) \braket{y_1 y_2}{\psi_{ab}} \\
&=
\int dx_1 dx_2
\braket{\psi_{nm}}{x_1 x_2} \delta(x_1 - x_2) \braket{x_1 x_2}{\psi_{ab}} \\
&=
\int_{-L/2}^{L/2} dx
\psi_{nm}(x, x)
\psi_{ab}(x, x).
\end{aligned}
\end{equation}
%
So, for our first order calculation we need
%
\begin{equation}\label{eqn:qmTwoPs4:510}
\begin{aligned}
H_{11; 11}'
&=
- c_0
\int_{-L/2}^{L/2} dx
\psi_{11}(x, x)
\psi_{11}(x, x) \\
&=
\frac{4}{L^2}
\int_{-L/2}^{L/2} dx
\cos^4( \pi x /L ) \\
&=
- \frac{3 c_0}{2 L}.
\end{aligned}
\end{equation}
%
For the second order perturbation of the energy, it is clear that this will reduce the first order approximation for each matrix element that is non-zero.
%
Attempting that calculation with \href{https://github.com/peeterjoot/physicsplay/blob/796c8e3739ae1a9ca26270a0e91384afba45661d/notes/phy456/problem\%20set\%204,\%20problem\%202.nb}{Mathematica} however, is deceiving, since Mathematica reports these all as zero after FullSimplify.  It appears, that as used, it does not allow for \(m = n\) and \(m = n \pm 1\) constraints properly where the denominators of the unsimplified integrals go zero, and more careful evaluation is required.  See \citep{stackoverflowMathematicaTrigSimplify} for details.
%
%This worksheet can be seen to be giving misleading results, by evaluating
%%
%\begin{equation}\label{eqn:qmTwoPs4:430}
%\int_{-\frac{L}{2}}^{\frac{L}{2}} \left(\frac{2}{L}\right)^2 \cos ^2\left(\frac{\pi  x}{L}\right) \cos ^2\left(\frac{3 \pi  x}{L}\right) \, dx = \frac{1}{L}
%\end{equation}
%%
%Yet, the FullSimplify cowardly refuses to reduce.
%%gives
%%
%%\begin{equation}\label{eqn:qmTwoPs4:450}
%%\text{FullSimplify}\left[\int_{-\frac{L}{2}}^{\frac{L}{2}} \text{Cos}\left[\frac{\pi  x}{L}\right]^2 \left(\frac{2}{L}\right)^2 \text{Cos}\left[\frac{(2 n+1) \pi  x}{L}\right] \text{Cos}\left[\frac{(2 m+1) \pi  x}{L}\right] \, dx,\{m,n\}\in \text{Integers}\right] = 0
%%\end{equation}
%%
%I am hoping that asking about this on \href{http://stackoverflow.com/questions/7743774/proper-way-to-simplify-integral-result-in-mathematica-given-integer-constraints}{stackoverflow} will clarify how to use Mathematica correctly for this calculation.
